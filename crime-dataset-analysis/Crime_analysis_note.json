{"paragraphs":[{"text":"%md # CRIME DATASET ANALYSIS\n","user":"anonymous","dateUpdated":"2018-08-19T17:55:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>CRIME DATASET ANALYSIS</h1>\n"}]},"apps":[],"jobName":"paragraph_1534701311082_1090030441","id":"20180819-175511_203294976","dateCreated":"2018-08-19T17:55:11+0000","dateStarted":"2018-08-19T17:55:58+0000","dateFinished":"2018-08-19T17:55:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:181"},{"text":"%spark2\nval rawDF = spark.read.\n\toptions(Map(\"header\" -> \"true\", \"quote\" -> \"\\\"\", \"inferSchema\" -> \"true\")).\n\tcsv(\"/user/maria_dev/rawdata/chicago/crime/Crimes_-_2001_to_present.csv\")\n\n// never take inferSchema into production. It is an unnecessary time-killer\n\nval crimeDF = rawDF.withColumnRenamed(\"Case Number\", \"case_no\").\n\twithColumnRenamed(\"Location Description\", \"location_desc\").\n\twithColumnRenamed(\"Primary Type\", \"crime_type\").\n\twithColumnRenamed(\"X Coordinate\", \"x_coord\").\n\twithColumnRenamed(\"Y Coordinate\", \"y_coord\").\n\twithColumnRenamed(\"Domestic\", \"domestic\").\n\twithColumnRenamed(\"Updated On\", \"update_dt\").\n\twithColumnRenamed(\"District\", \"district\").\n\twithColumnRenamed(\"Community Area\", \"community\").\n\twithColumnRenamed(\"FBI Code\", \"fbi_code\").\n\tselect(\"id\", \"case_no\", \"date\", \"block\", \"crime_type\", \"description\", \"location_desc\", \n\t\t\"arrest\", \"domestic\", \"district\", \"ward\", \"community\", \"update_dt\", \"year\", \n\t\t\"latitude\", \"longitude\")\n\n\ncrimeDF.printSchema","user":"anonymous","dateUpdated":"2018-08-19T17:59:43+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1534701405216_-1701986702","id":"20180819-175645_2045693068","dateCreated":"2018-08-19T17:56:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:183","dateFinished":"2018-08-19T18:02:03+0000","dateStarted":"2018-08-19T17:59:43+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"rawDF: org.apache.spark.sql.DataFrame = [ID: int, Case Number: string ... 20 more fields]\ncrimeDF: org.apache.spark.sql.DataFrame = [id: int, case_no: string ... 14 more fields]\nroot\n |-- id: integer (nullable = true)\n |-- case_no: string (nullable = true)\n |-- date: string (nullable = true)\n |-- block: string (nullable = true)\n |-- crime_type: string (nullable = true)\n |-- description: string (nullable = true)\n |-- location_desc: string (nullable = true)\n |-- arrest: boolean (nullable = true)\n |-- domestic: boolean (nullable = true)\n |-- district: integer (nullable = true)\n |-- ward: integer (nullable = true)\n |-- community: integer (nullable = true)\n |-- update_dt: string (nullable = true)\n |-- year: integer (nullable = true)\n |-- latitude: double (nullable = true)\n |-- longitude: double (nullable = true)\n\n"}]}},{"text":"%spark2\n\ncase class Crime(id: java.lang.Integer, case_no: String, date: String, block: String, crime_type: String, description: String, \n\tlocation_desc: String, arrest: Boolean, domestic: Boolean, district: java.lang.Integer, ward: java.lang.Integer, community: java.lang.Integer, \n\tupdate_dt: String, year: java.lang.Integer, longitude: java.lang.Double, latitude: java.lang.Double) extends java.io.Serializable {\n\n\tdef ledToArrest : Boolean = this.arrest\n\n\tdef isDomestic : Boolean = this.domestic\n}\n\nval crimeDS = crimeDF.as[Crime]","user":"anonymous","dateUpdated":"2018-08-19T18:02:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1534701583953_769132890","id":"20180819-175943_1894041949","dateCreated":"2018-08-19T17:59:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:368","dateFinished":"2018-08-19T18:02:19+0000","dateStarted":"2018-08-19T18:02:17+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class Crime\ncrimeDS: org.apache.spark.sql.Dataset[Crime] = [id: int, case_no: string ... 14 more fields]\n"}]}},{"text":"%spark2\nimport org.apache.spark.sql.expressions.Window\nval crimeYearDistrictCountDF = crimeDS.groupBy(\"crime_type\", \"district\", \"year\").count\nval windowPartition = Window.partitionBy(\"year\", \"district\").orderBy(desc(\"count\"))\nval rankingDF = crimeYearDistrictCountDF.withColumn(\"crime_rank\", rank().over(windowPartition)).filter($\"crime_rank\" <= 10).cache\n\nrankingDF.createOrReplaceTempView(\"ranking_crime\")","user":"anonymous","dateUpdated":"2018-08-19T18:04:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1534701737210_1567115788","id":"20180819-180217_199440032","dateCreated":"2018-08-19T18:02:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:467","dateFinished":"2018-08-19T18:05:02+0000","dateStarted":"2018-08-19T18:04:58+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.expressions.Window\ncrimeYearDistrictCountDF: org.apache.spark.sql.DataFrame = [crime_type: string, district: int ... 2 more fields]\nwindowPartition: org.apache.spark.sql.expressions.WindowSpec = org.apache.spark.sql.expressions.WindowSpec@6513844d\nrankingDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [crime_type: string, district: int ... 3 more fields]\n"}]}},{"text":"%sql\nselect * from ranking_crime where year = 2002","user":"anonymous","dateUpdated":"2018-08-19T18:10:47+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"lineChart":{}},"commonSetting":{},"keys":[{"name":"crime_type","index":0,"aggr":"sum"}],"groups":[{"name":"district","index":1,"aggr":"sum"}],"values":[{"name":"count","index":3,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1534701756839_-362369297","id":"20180819-180236_2023780750","dateCreated":"2018-08-19T18:02:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:548","dateFinished":"2018-08-19T18:06:52+0000","dateStarted":"2018-08-19T18:06:51+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"crime_type\tdistrict\tyear\tcount\tcrime_rank\nTHEFT\t19\t2002\t6997\t1\nBATTERY\t19\t2002\t2932\t2\nCRIMINAL DAMAGE\t19\t2002\t2435\t3\nBURGLARY\t19\t2002\t1702\t4\nOTHER OFFENSE\t19\t2002\t1539\t5\nDECEPTIVE PRACTICE\t19\t2002\t1326\t6\nNARCOTICS\t19\t2002\t1306\t7\nASSAULT\t19\t2002\t1083\t8\nCRIMINAL TRESPASS\t19\t2002\t1000\t9\nMOTOR VEHICLE THEFT\t19\t2002\t799\t10\nTHEFT\t17\t2002\t3430\t1\nBATTERY\t17\t2002\t2187\t2\nCRIMINAL DAMAGE\t17\t2002\t1986\t3\nOTHER OFFENSE\t17\t2002\t1265\t4\nBURGLARY\t17\t2002\t1179\t5\nMOTOR VEHICLE THEFT\t17\t2002\t1058\t6\nNARCOTICS\t17\t2002\t690\t7\nASSAULT\t17\t2002\t667\t8\nDECEPTIVE PRACTICE\t17\t2002\t449\t9\nROBBERY\t17\t2002\t429\t10\nBATTERY\t3\t2002\t5671\t1\nTHEFT\t3\t2002\t3521\t2\nCRIMINAL DAMAGE\t3\t2002\t2741\t3\nNARCOTICS\t3\t2002\t2273\t4\nASSAULT\t3\t2002\t1911\t5\nOTHER OFFENSE\t3\t2002\t1789\t6\nBURGLARY\t3\t2002\t1124\t7\nROBBERY\t3\t2002\t1121\t8\nMOTOR VEHICLE THEFT\t3\t2002\t1118\t9\nCRIMINAL TRESPASS\t3\t2002\t734\t10\nTHEFT\t12\t2002\t6263\t1\nBATTERY\t12\t2002\t4211\t2\nCRIMINAL DAMAGE\t12\t2002\t2827\t3\nNARCOTICS\t12\t2002\t2039\t4\nMOTOR VEHICLE THEFT\t12\t2002\t1525\t5\nASSAULT\t12\t2002\t1471\t6\nOTHER OFFENSE\t12\t2002\t1453\t7\nBURGLARY\t12\t2002\t1172\t8\nCRIMINAL TRESPASS\t12\t2002\t910\t9\nROBBERY\t12\t2002\t871\t10\nTHEFT\t8\t2002\t6577\t1\nBATTERY\t8\t2002\t5544\t2\nCRIMINAL DAMAGE\t8\t2002\t4771\t3\nMOTOR VEHICLE THEFT\t8\t2002\t2451\t4\nBURGLARY\t8\t2002\t2333\t5\nOTHER OFFENSE\t8\t2002\t2312\t6\nASSAULT\t8\t2002\t2009\t7\nNARCOTICS\t8\t2002\t1954\t8\nROBBERY\t8\t2002\t1225\t9\nDECEPTIVE PRACTICE\t8\t2002\t954\t10\nNARCOTICS\t11\t2002\t9236\t1\nBATTERY\t11\t2002\t6322\t2\nTHEFT\t11\t2002\t3052\t3\nCRIMINAL DAMAGE\t11\t2002\t2318\t4\nASSAULT\t11\t2002\t1776\t5\nROBBERY\t11\t2002\t1329\t6\nOTHER OFFENSE\t11\t2002\t1282\t7\nMOTOR VEHICLE THEFT\t11\t2002\t1166\t8\nBURGLARY\t11\t2002\t832\t9\nPROSTITUTION\t11\t2002\t642\t10\nBATTERY\t5\t2002\t5622\t1\nTHEFT\t5\t2002\t2777\t2\nCRIMINAL DAMAGE\t5\t2002\t2611\t3\nASSAULT\t5\t2002\t2030\t4\nNARCOTICS\t5\t2002\t1947\t5\nOTHER OFFENSE\t5\t2002\t1511\t6\nBURGLARY\t5\t2002\t1062\t7\nMOTOR VEHICLE THEFT\t5\t2002\t835\t8\nROBBERY\t5\t2002\t761\t9\nCRIMINAL TRESPASS\t5\t2002\t412\t10\nTHEFT\t22\t2002\t3028\t1\nBATTERY\t22\t2002\t2887\t2\nCRIMINAL DAMAGE\t22\t2002\t2065\t3\nNARCOTICS\t22\t2002\t1506\t4\nOTHER OFFENSE\t22\t2002\t1335\t5\nASSAULT\t22\t2002\t1056\t6\nMOTOR VEHICLE THEFT\t22\t2002\t947\t7\nBURGLARY\t22\t2002\t823\t8\nROBBERY\t22\t2002\t516\t9\nDECEPTIVE PRACTICE\t22\t2002\t422\t10\nTHEFT\t20\t2002\t2196\t1\nBATTERY\t20\t2002\t1560\t2\nCRIMINAL DAMAGE\t20\t2002\t1099\t3\nOTHER OFFENSE\t20\t2002\t776\t4\nNARCOTICS\t20\t2002\t681\t5\nASSAULT\t20\t2002\t559\t6\nBURGLARY\t20\t2002\t453\t7\nDECEPTIVE PRACTICE\t20\t2002\t372\t8\nMOTOR VEHICLE THEFT\t20\t2002\t352\t9\nCRIMINAL TRESPASS\t20\t2002\t318\t10\nBATTERY\t6\t2002\t5375\t1\nTHEFT\t6\t2002\t4718\t2\nCRIMINAL DAMAGE\t6\t2002\t2910\t3\nNARCOTICS\t6\t2002\t1991\t4\nOTHER OFFENSE\t6\t2002\t1858\t5\nASSAULT\t6\t2002\t1821\t6\nMOTOR VEHICLE THEFT\t6\t2002\t1590\t7\nBURGLARY\t6\t2002\t1309\t8\nROBBERY\t6\t2002\t1273\t9\nDECEPTIVE PRACTICE\t6\t2002\t724\t10\nNARCOTICS\t15\t2002\t5738\t1\nBATTERY\t15\t2002\t4492\t2\nTHEFT\t15\t2002\t2012\t3\nCRIMINAL DAMAGE\t15\t2002\t1724\t4\nASSAULT\t15\t2002\t1246\t5\nOTHER OFFENSE\t15\t2002\t1219\t6\nMOTOR VEHICLE THEFT\t15\t2002\t800\t7\nROBBERY\t15\t2002\t718\t8\nBURGLARY\t15\t2002\t578\t9\nPROSTITUTION\t15\t2002\t543\t10\nBATTERY\t9\t2002\t4912\t1\nTHEFT\t9\t2002\t4128\t2\nCRIMINAL DAMAGE\t9\t2002\t3256\t3\nNARCOTICS\t9\t2002\t2628\t4\nASSAULT\t9\t2002\t1629\t5\nBURGLARY\t9\t2002\t1537\t6\nMOTOR VEHICLE THEFT\t9\t2002\t1505\t7\nOTHER OFFENSE\t9\t2002\t1427\t8\nROBBERY\t9\t2002\t863\t9\nDECEPTIVE PRACTICE\t9\t2002\t518\t10\nTHEFT\t25\t2002\t5206\t1\nBATTERY\t25\t2002\t4781\t2\nCRIMINAL DAMAGE\t25\t2002\t3385\t3\nNARCOTICS\t25\t2002\t2596\t4\nMOTOR VEHICLE THEFT\t25\t2002\t2014\t5\nBURGLARY\t25\t2002\t1969\t6\nOTHER OFFENSE\t25\t2002\t1845\t7\nASSAULT\t25\t2002\t1764\t8\nROBBERY\t25\t2002\t1218\t9\nPROSTITUTION\t25\t2002\t701\t10\nTHEFT\t16\t2002\t3961\t1\nCRIMINAL DAMAGE\t16\t2002\t2755\t2\nBATTERY\t16\t2002\t2072\t3\nOTHER OFFENSE\t16\t2002\t1717\t4\nBURGLARY\t16\t2002\t1049\t5\nASSAULT\t16\t2002\t863\t6\nMOTOR VEHICLE THEFT\t16\t2002\t821\t7\nDECEPTIVE PRACTICE\t16\t2002\t740\t8\nNARCOTICS\t16\t2002\t635\t9\nCRIMINAL TRESPASS\t16\t2002\t559\t10\nTHEFT\t24\t2002\t3377\t1\nBATTERY\t24\t2002\t2597\t2\nCRIMINAL DAMAGE\t24\t2002\t1973\t3\nOTHER OFFENSE\t24\t2002\t1287\t4\nNARCOTICS\t24\t2002\t1108\t5\nBURGLARY\t24\t2002\t1002\t6\nASSAULT\t24\t2002\t839\t7\nMOTOR VEHICLE THEFT\t24\t2002\t663\t8\nROBBERY\t24\t2002\t635\t9\nDECEPTIVE PRACTICE\t24\t2002\t552\t10\nBATTERY\t2\t2002\t6779\t1\nTHEFT\t2\t2002\t5236\t2\nNARCOTICS\t2\t2002\t4125\t3\nCRIMINAL DAMAGE\t2\t2002\t2771\t4\nASSAULT\t2\t2002\t1983\t5\nOTHER OFFENSE\t2\t2002\t1873\t6\nCRIMINAL TRESPASS\t2\t2002\t1866\t7\nBURGLARY\t2\t2002\t1393\t8\nMOTOR VEHICLE THEFT\t2\t2002\t1356\t9\nROBBERY\t2\t2002\t1252\t10\nBATTERY\t7\t2002\t8082\t1\nTHEFT\t7\t2002\t3393\t2\nNARCOTICS\t7\t2002\t3376\t3\nCRIMINAL DAMAGE\t7\t2002\t3144\t4\nASSAULT\t7\t2002\t2494\t5\nOTHER OFFENSE\t7\t2002\t1586\t6\nMOTOR VEHICLE THEFT\t7\t2002\t1303\t7\nBURGLARY\t7\t2002\t1287\t8\nROBBERY\t7\t2002\t1161\t9\nCRIMINAL TRESPASS\t7\t2002\t414\t10\nBATTERY\t4\t2002\t5695\t1\nTHEFT\t4\t2002\t4215\t2\nCRIMINAL DAMAGE\t4\t2002\t3728\t3\nASSAULT\t4\t2002\t2183\t4\nOTHER OFFENSE\t4\t2002\t2001\t5\nNARCOTICS\t4\t2002\t1956\t6\nMOTOR VEHICLE THEFT\t4\t2002\t1374\t7\nBURGLARY\t4\t2002\t1239\t8\nROBBERY\t4\t2002\t1046\t9\nCRIMINAL TRESPASS\t4\t2002\t662\t10\nTHEFT\t14\t2002\t5717\t1\nBATTERY\t14\t2002\t3532\t2\nCRIMINAL DAMAGE\t14\t2002\t2791\t3\nBURGLARY\t14\t2002\t1487\t4\nMOTOR VEHICLE THEFT\t14\t2002\t1453\t5\nASSAULT\t14\t2002\t1273\t6\nOTHER OFFENSE\t14\t2002\t1236\t7\nNARCOTICS\t14\t2002\t1232\t8\nPROSTITUTION\t14\t2002\t922\t9\nROBBERY\t14\t2002\t912\t10\nTHEFT\t18\t2002\t8781\t1\nBATTERY\t18\t2002\t2912\t2\nCRIMINAL DAMAGE\t18\t2002\t1684\t3\nNARCOTICS\t18\t2002\t1507\t4\nDECEPTIVE PRACTICE\t18\t2002\t1414\t5\nCRIMINAL TRESPASS\t18\t2002\t1200\t6\nOTHER OFFENSE\t18\t2002\t1029\t7\nASSAULT\t18\t2002\t898\t8\nBURGLARY\t18\t2002\t826\t9\nROBBERY\t18\t2002\t583\t10\nTHEFT\t1\t2002\t6998\t1\nBATTERY\t1\t2002\t1393\t2\nDECEPTIVE PRACTICE\t1\t2002\t1196\t3\nOTHER OFFENSE\t1\t2002\t1091\t4\nCRIMINAL TRESPASS\t1\t2002\t1046\t5\nCRIMINAL DAMAGE\t1\t2002\t740\t6\nASSAULT\t1\t2002\t689\t7\nNARCOTICS\t1\t2002\t597\t8\nMOTOR VEHICLE THEFT\t1\t2002\t397\t9\nBURGLARY\t1\t2002\t353\t10\nBATTERY\t10\t2002\t4594\t1\nTHEFT\t10\t2002\t2744\t2\nNARCOTICS\t10\t2002\t2668\t3\nCRIMINAL DAMAGE\t10\t2002\t2226\t4\nASSAULT\t10\t2002\t1277\t5\nOTHER OFFENSE\t10\t2002\t1168\t6\nMOTOR VEHICLE THEFT\t10\t2002\t1096\t7\nROBBERY\t10\t2002\t984\t8\nBURGLARY\t10\t2002\t914\t9\nCRIMINAL TRESPASS\t10\t2002\t371\t10\n"}]}},{"text":"%sql\n","user":"anonymous","dateUpdated":"2018-08-19T18:05:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1534701954876_1774601070","id":"20180819-180554_1135633293","dateCreated":"2018-08-19T18:05:54+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1045"}],"name":"Crime_analysis_note","id":"2DNG7TBW7","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}